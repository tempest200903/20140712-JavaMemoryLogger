<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>D3 Test</title>
<script type="text/javascript" src="d3/d3.js"></script>
</head>
<body>
	<script type="text/javascript">
		var dataset = [ 1, 2, 3, 4, 5 ];
		var w = 500;
		var h = 500;
		var barPadding = 1;
		var dataMax = Math.max.apply(null, dataset);
		var scale = 500 / dataMax;

		var svg = d3.select("body").append("svg").attr("width", w).attr(
				"height", h);

		svg.selectAll("rect").data(dataset).enter().append("rect").attr("x",
				function(d, i) {
					return i * (w / dataset.length);
				}).attr("y", function(d) {
			return h - (d * scale); // SVG の高さからデータの値を引く
		}).attr("width", w / dataset.length - barPadding).attr("height",
				function(d) {
					return d * scale; // データの値そのもの
				}).attr("fill", function(d) {
			return "rgb(0, 0, " + (d * 10) + ")";
		})

		svg.selectAll("text").data(dataset).enter().append("text").attr(
				"x",
				function(d, i) {
					return i * (w / dataset.length)
							+ (w / dataset.length - barPadding) / 2;
				}).attr("y", function(d) {
			return h - (d * scale) + 14; // 15 を 14 に
		}).text(function(d) {
			return (d / 1000).toFixed(0);
		}).attr("font-family", "sans-serif").attr("font-size", "11px").attr(
				"fill", "white").attr("text-anchor", "middle");
	</script>
</body>
</html>
